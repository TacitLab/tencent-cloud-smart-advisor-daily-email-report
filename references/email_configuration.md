# 邮箱配置参考指南

## 支持的邮箱服务商

### 1. 腾讯企业邮 (推荐)
- **IMAP服务器**: `imap.exmail.qq.com`
- **端口**: 993 (SSL)
- **SMTP服务器**: `smtp.exmail.qq.com`
- **端口**: 465 (SSL) 或 587 (TLS)
- **特点**: 稳定、安全、适合企业使用

### 2. QQ邮箱
- **IMAP服务器**: `imap.qq.com`
- **端口**: 993 (SSL)
- **特点**: 个人用户友好，需要开启IMAP服务

### 3. Gmail
- **IMAP服务器**: `imap.gmail.com`
- **端口**: 993 (SSL)
- **特点**: 需要应用专用密码，两步验证用户必须使用

### 4. Outlook/Hotmail
- **IMAP服务器**: `imap-mail.outlook.com`
- **端口**: 993 (SSL)
- **特点**: Microsoft生态，良好的企业支持

## 安全配置

### 应用专用密码 (推荐)

#### Gmail
1. 开启两步验证
2. 访问：https://myaccount.google.com/apppasswords
3. 生成应用专用密码
4. 在配置中使用生成的密码

#### QQ邮箱/腾讯企业邮
1. 登录邮箱设置
2. 开启IMAP/SMTP服务
3. 生成授权码
4. 使用授权码作为密码

#### Outlook
1. 开启两步验证
2. 访问：https://account.microsoft.com/security
3. 生成应用密码
4. 使用生成的密码

### 环境变量配置

```bash
# IMAP服务器配置
export EMAIL_HOST="imap.exmail.qq.com"
export EMAIL_USER="your-email@company.com"
export EMAIL_PASS="your-app-password"

# 监控配置
export EMAIL_SENDER="email@advisor.cloud.tencent.com"
export EMAIL_HOURS="24"
```

## 常见问题排查

### 连接失败

**症状**: `imaplib.IMAP4.error: [AUTHENTICATIONFAILED] Invalid credentials`

**解决方案**:
1. 检查用户名和密码是否正确
2. 确认是否使用了应用专用密码
3. 验证IMAP服务是否已开启
4. 检查网络连接和防火墙设置

**症状**: `Connection refused` 或 `Timeout`

**解决方案**:
1. 检查IMAP服务器地址是否正确
2. 确认端口993是否开放
3. 检查防火墙和网络设置
4. 尝试使用不同的网络环境

### 认证问题

**症状**: `Invalid credentials` 但密码正确

**解决方案**:
1. 确认是否开启了两步验证
2. 检查是否使用了正确的应用专用密码
3. 验证账户是否有IMAP访问权限
4. 检查账户是否被锁定或限制

### 搜索问题

**症状**: 搜索不到邮件或结果不完整

**解决方案**:
1. 检查搜索条件语法是否正确
2. 确认时间范围设置合理
3. 验证发件人地址是否完全匹配
4. 检查邮箱是否有足够的邮件数量

## 性能优化

### 连接池
- 重用IMAP连接减少开销
- 合理设置连接超时时间
- 使用连接池管理多个邮箱

### 搜索优化
- 使用精确的时间范围
- 避免全邮箱搜索
- 合理使用搜索条件组合

### 数据缓存
- 缓存常用的邮箱信息
- 本地存储历史数据
- 定期清理过期缓存

## 安全最佳实践

### 密码管理
- 始终使用应用专用密码
- 定期更换密码
- 不要在代码中硬编码密码
- 使用环境变量存储敏感信息

### 网络连接
- 始终使用SSL/TLS加密
- 验证服务器证书
- 避免在公共网络传输敏感信息

### 数据保护
- 本地加密存储敏感数据
- 定期清理临时文件
- 限制数据访问权限
- 遵守数据保护法规

## 监控和维护

### 健康检查
- 定期检查邮箱连接状态
- 监控认证失败率
- 跟踪搜索性能指标

### 日志记录
- 记录所有连接和操作
- 监控错误和异常情况
- 定期分析日志数据

### 备份策略
- 定期备份配置文件
- 保存重要的历史数据
- 建立灾难恢复计划